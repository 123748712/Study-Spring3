<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:security="http://www.springframework.org/schema/security"
	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
		http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security-5.2.xsd">

	<!-- web 보안 --> <!-- auto-config 키워드 등록 태그 -->
	<security:http use-expressions="true"> <!-- 인증 설정 태그 -->
		<!-- 인증이 필요한 페이지를 등록하고 해당하는 권한을 설정 -->
		<!-- pattern : 권한과 인증이 필요한 페이지 등록 -->
		<!-- access : 권한을 가진 롤 옵션 등록(표현식에 따라 권한 다름), access 순서에 따라 에러발생(중요 !) -->
		<security:intercept-url pattern="/fbi/all" access="permitAll" />
		<security:intercept-url pattern="/fbi/member" access="hasRole('ROLE_MEMBER')" /> <!-- 해당 권한을 가졌는지 검사 -->
		<security:intercept-url pattern="/fbi/admin" access="hasRole('ROLE_ADMIN')" /> <!-- 해당 권한을 가졌는지 검사 -->
		<security:intercept-url pattern="/fbi/soo" access="hasRole('ROLE_SOO')" /> <!-- 해당 권한을 가졌는지 검사 -->
		
		<!-- 위에 설정한 url 제외 권한 열기 -->
		<security:intercept-url pattern="/**" access="permitAll" /> <!-- 모두 허용 -->
		<!-- auto-config 키워드 등록시 login, logout 태그 열지 않아도 됨 그러나 잘 사용하지 않음-->
		<security:form-login login-page="/mylogin" /> <!-- controller에서 get으로 화면출력의 용도처럼 url 등록 -->
		<security:logout/> <!-- 로그아웃시 자동으로 로그인화면 전환 -->
	</security:http>
	
	<!-- 인증 관리자 설정 -->
	<security:authentication-manager>
		<security:authentication-provider>
			<!-- inMemory USER 설정으로 간단하게 USER 등록 -->
			<security:user-service> <!-- 접근 USER 등록 권한 여러개 줄수 있음 -->
				<security:user name="admin" password="{noop}admin" authorities="ROLE_ADMIN, ROLE_SOO, ROLE_MEMBER"/>
				<security:user name="soo" password="{noop}soo" authorities="ROLE_SOO"/>
			</security:user-service>
		</security:authentication-provider>
	</security:authentication-manager>
</beans>	